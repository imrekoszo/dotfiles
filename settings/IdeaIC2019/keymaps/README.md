Adopted a lot from http://mishadoff.com/blog/idea-for-clojure/
